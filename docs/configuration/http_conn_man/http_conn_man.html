

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>HTTP connection manager &mdash; envoy 1.0.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="envoy 1.0.0 documentation" href="../../index.html"/>
        <link rel="up" title="Configuration reference" href="../configuration.html"/>
        <link rel="next" title="Route configuration" href="route_config/route_config.html"/>
        <link rel="prev" title="TCP proxy" href="../network_filters/tcp_proxy_filter.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> envoy
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about_docs.html">About the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro/intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/install.html">Building and installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../configuration.html">Configuration reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../listeners/listeners.html">Listeners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../network_filters/network_filters.html">Network filters</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">HTTP connection manager</a><ul>
<li class="toctree-l3"><a class="reference internal" href="route_config/route_config.html">Route configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="filters.html">Filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="access_log.html">Access logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="headers.html">HTTP header manipulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="stats.html">Statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="runtime.html">Runtime</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../http_filters/http_filters.html">HTTP filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cluster_manager/cluster_manager.html">Cluster manager</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../operations/operations.html">Operations and administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extending/extending.html">Extending Envoy for custom use cases</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">envoy</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../configuration.html">Configuration reference</a> &raquo;</li>
      
    <li>HTTP connection manager</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/configuration/http_conn_man/http_conn_man.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="http-connection-manager">
<span id="config-http-conn-man"></span><h1>HTTP connection manager<a class="headerlink" href="#http-connection-manager" title="Permalink to this headline">Â¶</a></h1>
<ul class="simple">
<li>HTTP connection manager <a class="reference internal" href="../../intro/arch_overview/http_connection_management.html#arch-overview-http-conn-man"><span class="std std-ref">architecture overview</span></a>.</li>
<li>HTTP protocols <a class="reference internal" href="../../intro/arch_overview/http_connection_management.html#arch-overview-http-protocols"><span class="std std-ref">architecture overview</span></a>.</li>
</ul>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;read&quot;</span><span class="p">,</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;http_connection_manager&quot;</span><span class="p">,</span>
  <span class="nt">&quot;config&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;codec_type&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="nt">&quot;stat_prefix&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="nt">&quot;route_config&quot;</span><span class="p">:</span> <span class="s2">&quot;{...}&quot;</span><span class="p">,</span>
    <span class="nt">&quot;filters&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="nt">&quot;add_user_agent&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="nt">&quot;tracing_enabled&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="nt">&quot;http_codec_options&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="nt">&quot;server_name&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="nt">&quot;idle_timeout_s&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span><span class="p">,</span>
    <span class="nt">&quot;access_log&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="nt">&quot;use_remote_address&quot;</span><span class="p">:</span> <span class="s2">&quot;...&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="docutils" id="config-http-conn-man-codec-type">
<dt>codec_type</dt>
<dd><p class="first"><em>(required, string)</em> Supplies the type of codec that the connection manager should use. Possible
values are:</p>
<dl class="last docutils">
<dt>http1</dt>
<dd>The connection manager will assume that the client is speaking HTTP/1.1.</dd>
<dt>http2</dt>
<dd>The connection manager will assume that the client is speaking HTTP/2 (Envoy does not require
HTTP/2 to take place over TLS or to use ALPN. Prior knowledge is allowed).</dd>
<dt>auto</dt>
<dd>For every new connection, the connection manager will determine which codec to use. This mode
supports both ALPN for TLS listeners as well as protocol inference for plaintext listeners.
If ALPN data is available, it is preferred, otherwise protocol inference is used. In almost
all cases, this is the right option to choose for this setting.</dd>
</dl>
</dd>
</dl>
<dl class="docutils" id="config-http-conn-man-stat-prefix">
<dt>stat_prefix</dt>
<dd><em>(required, string)</em> The human readable prefix to use when emitting statistics for the
connection manager. See the <a class="reference internal" href="stats.html#config-http-conn-man-stats"><span class="std std-ref">statistics</span></a> documentation
for more information.</dd>
<dt><a class="reference internal" href="route_config/route_config.html#config-http-conn-man-route-table"><span class="std std-ref">route_config</span></a></dt>
<dd><em>(required, object)</em> The <a class="reference internal" href="../../intro/arch_overview/http_routing.html#arch-overview-http-routing"><span class="std std-ref">route table</span></a> for the connection
manager. All connection managers must have a route table, even if it is empty.</dd>
<dt><a class="reference internal" href="filters.html#config-http-conn-man-filters"><span class="std std-ref">filters</span></a></dt>
<dd><em>(required, array)</em> A list of individual <a class="reference internal" href="../../intro/arch_overview/http_filters.html#arch-overview-http-filters"><span class="std std-ref">HTTP filters</span></a> that
make up the filter chain for requests made to the connection manager. Order matters as the filters
are processed sequentially as request events happen.</dd>
</dl>
<dl class="docutils" id="config-http-conn-man-add-user-agent">
<dt>add_user_agent</dt>
<dd><em>(optional, boolean)</em> Whether the connection manager manipulates the
<a class="reference internal" href="headers.html#config-http-conn-man-headers-user-agent"><span class="std std-ref">user-agent</span></a> and
<a class="reference internal" href="headers.html#config-http-conn-man-headers-downstream-service-cluster"><span class="std std-ref">x-envoy-downstream-service-cluster</span></a> headers. See the linked
documentation for more information. Defaults to false.</dd>
</dl>
<dl class="docutils" id="config-http-conn-man-tracing-enabled">
<dt>tracing_enabled</dt>
<dd><em>(optional, boolean)</em> Whether the connection manager emits <a class="reference internal" href="../../intro/arch_overview/tracing.html#arch-overview-tracing"><span class="std std-ref">tracing</span></a>
data to the <a class="reference internal" href="../overview/tracing.html#config-tracing"><span class="std std-ref">configured tracing provider</span></a>. Defaults to false.</dd>
</dl>
<dl class="docutils" id="config-http-conn-man-http-codec-options">
<dt>http_codec_options</dt>
<dd><p class="first"><em>(optional, string)</em> Additional options that are passed directly to the codec. Not all options
are applicable to all codecs. Possible values are:</p>
<dl class="docutils">
<dt>no_compression</dt>
<dd>The codec will not use compression. In practice this only applies to HTTP/2 which will disable
header compression if set.</dd>
</dl>
<p class="last">These are the same options available in the upstream cluster <a class="reference internal" href="../cluster_manager/cluster.html#config-cluster-manager-cluster-http-codec-options"><span class="std std-ref">http_codec_options</span></a> option. See the comment there about
disabling HTTP/2 header compression.</p>
</dd>
</dl>
<dl class="docutils" id="config-http-conn-man-server-name">
<dt>server_name</dt>
<dd><em>(optional, string)</em> An optional override that the connection manager will write to the
<a class="reference internal" href="headers.html#config-http-conn-man-headers-server"><span class="std std-ref">server</span></a> header in responses. If not set, the default is
<em>envoy</em>.</dd>
<dt>idle_timeout_s</dt>
<dd><em>(optional, integer)</em> The idle timeout in seconds for connections managed by the connection
manager. The idle timeout is defined as the period in which there are no active requests. If not
set, there is no idle timeout. When the idle timeout is reached the connection will be closed. If
the connection is an HTTP/2 connection a GOAWAY frame will be sent prior to closing
the connection.</dd>
<dt><a class="reference internal" href="access_log.html#config-http-conn-man-access-log"><span class="std std-ref">access_log</span></a></dt>
<dd><em>(optional, array)</em> Configuration for <a class="reference internal" href="../../intro/arch_overview/http_connection_management.html#arch-overview-http-access-logs"><span class="std std-ref">HTTP access logs</span></a>
emitted by the connection manager.</dd>
</dl>
<dl class="docutils" id="config-http-conn-man-use-remote-address">
<dt>use_remote_address</dt>
<dd><em>(optional, boolean)</em> If set to true, the connection manager will use the real remote address
of the client connection when determining internal versus external origin and manipulating
various headers. If set to false or absent, the connection manager will use the
<a class="reference internal" href="headers.html#config-http-conn-man-headers-x-forwarded-for"><span class="std std-ref">x-forwarded-for</span></a> HTTP header. See the documentation for
<a class="reference internal" href="headers.html#config-http-conn-man-headers-x-forwarded-for"><span class="std std-ref">x-forwarded-for</span></a>,
<a class="reference internal" href="headers.html#config-http-conn-man-headers-x-envoy-internal"><span class="std std-ref">x-envoy-internal</span></a>, and
<a class="reference internal" href="headers.html#config-http-conn-man-headers-x-envoy-external-address"><span class="std std-ref">x-envoy-external-address</span></a> for more information.</dd>
</dl>
<div class="toctree-wrapper compound">
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="route_config/route_config.html" class="btn btn-neutral float-right" title="Route configuration" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../network_filters/tcp_proxy_filter.html" class="btn btn-neutral" title="TCP proxy" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Lyft.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>